{% extends "base.html" %}
{% block title %}{{ dish.name }} | Kitchen Service{% endblock %}

{% block content %}
<div class="dish-detail-container">

  <div class="detail-header d-flex justify-content-between align-items-center mb-4">
    <div>
      <h1 class="fw-bold mb-1">{{ dish.name }}</h1>
    </div>
    <div>
			{% if request.user in dish.cooks.all %}
				<a href="{% url 'kitchen:dish-toggle-button' dish.pk %}" class="btn btn-outline-primary rounded-pill shadow-sm px-4 me-2">
        Remove me from cooks
      </a>
			{% else %}
				<a href="{% url 'kitchen:dish-toggle-button' dish.pk %}" class="btn btn-outline-primary rounded-pill shadow-sm px-4 me-2">
        Add me to cooks
      </a>
			{% endif %}

      {% if request.user.is_staff %}
				<a href="{% url 'kitchen:dish-update' dish.pk %}" class="btn btn-outline-primary rounded-pill shadow-sm px-4 me-2">
        âœï¸ Update
      </a>
      <a href="{% url 'kitchen:dish-delete' dish.pk %}" class="btn btn-outline-danger rounded-pill shadow-sm px-4">
        ğŸ—‘ï¸ Delete
      </a>
		{% endif %}
			<a href="{% url 'kitchen:suggestion-create' object.id %}" class="btn btn-outline-primary rounded-pill shadow-sm px-4 me-2">
				ğŸ’¡ Suggest Improvement
			</a>
    </div>
  </div>

  <div class="card shadow-sm border-0 mb-4 dish-info-card">
    <div class="card-body">
      <h5 class="card-title mb-3 text-primary">Description</h5>
      <p class="card-text text-secondary">{{ dish.description }}</p>

      <div class="d-flex justify-content-between align-items-center mt-4">
        <h5 class="fw-bold text-success mb-0">ğŸ’²{{ dish.price }}</h5>
        <span class="badge bg-light text-dark border rounded-pill px-3 py-2">
          {{ dish.dish_type.name }}
        </span>
      </div>
    </div>
  </div>

  <div class="info-grid">
    <div class="card border-0 shadow-sm">
      <div class="card-body">
        <h5 class="text-primary mb-3">ğŸŒ¿ Ingredients</h5>
        {% if dish.ingredients.all %}
          <ul class="list-group list-group-flush">
            {% for ingredient in dish.ingredients.all %}
              <li class="list-group-item">{{ ingredient.name }}</li>
            {% endfor %}
          </ul>
        {% else %}
          <p class="text-muted">No ingredients listed.</p>
        {% endif %}
      </div>
    </div>

    <div class="card border-0 shadow-sm">
      <div class="card-body">
        <h5 class="text-primary mb-3">ğŸ‘¨â€ğŸ³ Cooks</h5>
        {% if dish.cooks.all %}
          <ul class="list-group list-group-flush">
            {% for cook in dish.cooks.all %}
							{% if request.user.id == cook.id %}
								<li class="list-group-item">
                {{ cook.first_name }} {{ cook.last_name }} ({{ cook.username }}) (Me)
                â€” <span class="text-muted">{{ cook.years_of_experience }} years exp.</span>
              </li>
							{% else %}
								<li class="list-group-item">
                {{ cook.first_name }} {{ cook.last_name }} ({{ cook.username }})
                â€” <span class="text-muted">{{ cook.years_of_experience }} years exp.</span>
              </li>
							{% endif %}
            {% endfor %}
          </ul>
        {% else %}
          <p class="text-muted">No cooks assigned yet.</p>
        {% endif %}
      </div>
    </div>
  </div>
</div>
{% endblock %}
